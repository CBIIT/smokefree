!function(p,f,h,s){"use strict";var n="buildQuitPlan",a={propertyName:"value"},g={autoclose:!0,format:"mm-dd-yyyy"},v="errorQuitDay",k="show",D="hide",w={},d={_24HoursDate:[],_48HoursDate:[],oneWeekDate:[],twoWeeksDate:[],oneMonthDate:[]},y=function(e){var t={category:"QuitPlan",action:s,label:s},n={};p.extend(n,t,e),f.ga&&f.ga("send","event",n.category,n.action,n.label)},b=function(e){var t=10;h.body.scrollTop>e.offset().top&&(t=-10),p("html, body").stop().animate({scrollTop:e.offset().top+t},250,"swing")},q=function(e,t){var n="https://addevent.com/dir/?client="+Drupal.settings.icfi_api_keys.addevent+"&service="+encodeURIComponent(e)+"&start="+encodeURIComponent(t.date.replace(new RegExp("-","g"),"/"))+"&end="+encodeURIComponent(t.date.replace(new RegExp("-","g"),"/"))+"&title="+encodeURIComponent(t.title)+"&date_format="+encodeURIComponent("MM/DD/YYYY")+"&timezone="+encodeURIComponent("America/Chicago")+"&all_day_event=true";f.open(n)},C=function(e,t){var n;switch(e){case v:n="#error-quit-day";break;case"errorTriggers":n="#error-triggers";break;case"errerReminders":n="#error-reminders"}p(n).collapse(t)},I=function(e){return/[0-9]{2}-[0-9]{2}-[0-9]{4}/.test(e)},c=function(e){var t=e.find(".milestone-input"),n=[];return t.each(function(){var e=p(this).val();0<e.length&&n.push(e)}),n.join(",")},r={"valid-checklist":function(e){var t=e.find('input[type="checkbox"]:checked').length,n=e.eq(0).attr("id");return 0===t?p(h.getElementById("get."+n)).removeClass("in"):p(h.getElementById("get."+n)).addClass("in"),0<t},"valid-milestone":function(e){var t,n,a=0,i=e.find("#quit-day").eq(0).val().length,o=e.eq(0).attr("id");return p.each(d,function(e,t){var n=t.length;a+=n,n?p("#get\\.milestones\\."+e).addClass("in"):p("#get\\.milestones\\."+e).removeClass("in")}),t=d._48HoursDate.length+d.twoWeeksDate.length,n=d._24HoursDate.length+d.oneWeekDate.length+d.oneMonthDate.length,0===a?p(h.getElementById("get."+o)).removeClass("in"):p(h.getElementById("get."+o)).addClass("in"),0===t?p(h.getElementById("get.milestones.activites")).removeClass("in"):p(h.getElementById("get.milestones.activites")).addClass("in"),0===n?p(h.getElementById("get.milestones.rewards")).removeClass("in"):p(h.getElementById("get.milestones.rewards")).addClass("in"),0<i}},u=function(e,t){p(h.getElementById("get.milestones."+e)).find(".milestone-selections").append('<li><span class="plan-input date">{{date}}</span> <span class="plan-input title">{{title}}</span></li>'.replace("{{date}}",t.date).replace("{{title}}",t.title))},_=function(e){e.on("click",".modal-reward .dropdown-menu button",function(e){e.preventDefault();var t,n,a,i,o,s=p(this).parents(".modal"),r=s.attr("data-milestone"),l=p(this).attr("data-service");a=!1,i=(n=s).find(".milestone-date-picker").val(),o=c(n),I(i)&&0<o.length&&(a=!0),a?(s.find(".validation-error").removeClass("in"),s.find(".validation-success").addClass("in"),t={date:s.find(".milestone-date-picker").val(),title:c(s)},d[r].push(t),u(r,t),q(l,t),s.find(".milestone-input").val(""),s.find(".milestone-date-picker").datepicker("setDate",w[r])):(s.find(".validation-error").addClass("in"),s.find(".validation-success").removeClass("in"))})},E=function(e){e.on("click",".modal-activity .dropdown-menu button",function(e){e.preventDefault(),e.stopPropagation();var t,n,a,i,o,s=p(this).parents(".modal"),r=s.attr("data-milestone"),l=p(this).attr("data-service");a=!1,i=(n=s).find(".milestone-date-picker").val(),o=n.find(".milestone-input").eq(0).val(),I(i)&&0<o.length&&(a=!0),a?(s.find(".validation-error").removeClass("in"),s.find(".validation-success").addClass("in"),t={date:s.find(".milestone-date-picker").val(),title:s.find(".milestone-input").eq(0).val()},d[r].push(t),u(r,t),q(l,t),s.find(".milestone-input").val(""),s.find(".milestone-date-picker").datepicker("setDate",w[r])):(s.find(".validation-error").addClass("in"),s.find(".validation-success").removeClass("in"))})},i=function(e){var n=[];return p.each(e,function(e,t){n.push(t.date+" "+t.title)}),n.join("<br />")},W=function(e){var t,n=e.find("#build-your-quit-plan"),a=e.find("#get-quit-plan"),o=a.find("#get-quit-plan-header");e.find("#get-my-quit-plan").on("click",function(){var i;i=!0,e.find("#build-your-quit-plan").children("section").each(function(){var e,t=p(this),n=t.attr("data-validation"),a=t.attr("data-required")!==s;n!==s&&(!(e=r[n](t))&&a&&(i=!1),a&&!e?t.find(".validation-error").addClass("in"):a&&e&&t.find(".validation-error").removeClass("in"))}),(t=i)?(n.attr("aria-hidden",!0).removeClass("in"),p("#progress_bar").hide(),a.attr("aria-hidden",!1).addClass("in"),o.focus(),b(p("#get-quit-plan"))):b(p(".section-error.in").eq(0)),y({action:"GetQuitPlan",label:t?"valid":"invalid"})}),e.find("#edit-my-quit-plan, #edit-my-quit-plan-bottom").on("click",function(){n.attr("aria-hidden",!1).addClass("in"),a.attr("aria-hidden",!0).removeClass("in")}),e.find("#generate-pdf, #generate-pdf-bottom").on("click",function(){e.find("#milestones\\.24hours").val(i(d._24HoursDate)),e.find("#milestones\\.48hours").val(i(d._48HoursDate)),e.find("#milestones\\.oneWeek").val(i(d.oneWeekDate)),e.find("#milestones\\.twoWeeks").val(i(d.twoWeeksDate)),e.find("#milestones\\.oneMonth").val(i(d.oneMonthDate)),e.find("#build-your-quit-plan").submit(),y({action:"GetPrintablePDF"})})};function t(e,t){this.element=e,this.settings=p.extend({},a,t),this._defaults=a,this._name=n,this.init()}p.extend(t.prototype,{init:function(){var a,t,e,n,i,o,s,r,l,d,c,u,m=p(this.element);m.on("click",".trigger-scroll",function(e){e.preventDefault();var t=p(this.hash);b(t)}),t=(a=m).find("#quit-day"),e=a.find("#milestones"),t.datepicker(g).on("changeDate",function(){I(t.val())?(a.trigger("dateSet.quitPlan"),C(v,D),y({action:"QuitDate",label:t.val()})):C(v,k)}),t.on("blur",function(){I(t.val())?(a.trigger("dateSet.quitPlan"),C(v,D)):C(v,k)}),a.one("dateSet.quitPlan",function(){e.addClass("in")}),p("#dropdown-add-calendar-quit-day button").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=a.find("#quit-day").val(),n=p(this).attr("data-service");I(t)&&q(n,{date:t,title:"My quit day"})}),a.on("dateSet.quitPlan",function(){var e;p("#get-quit-day").text(t.val()),w.quitDate=t.datepicker("getDate"),e=w.quitDate.getDate(),w._24HoursDate=new Date(w.quitDate),w._24HoursDate.setDate(e+1),w._48HoursDate=new Date(w.quitDate),w._48HoursDate.setDate(e+2),w.oneWeekDate=new Date(w.quitDate),w.oneWeekDate.setDate(e+7),w.twoWeeksDate=new Date(w.quitDate),w.twoWeeksDate.setDate(e+14),w.oneMonthDate=new Date(w.quitDate),w.oneMonthDate.setMonth(w.quitDate.getMonth()+1),p(h.getElementById("milestones.24Hours.date")).datepicker("setDate",w._24HoursDate),p(h.getElementById("milestones.48Hours.date")).datepicker("setDate",w._48HoursDate),p(h.getElementById("milestones.oneWeek.date")).datepicker("setDate",w.oneWeekDate),p(h.getElementById("milestones.twoWeeks.date")).datepicker("setDate",w.twoWeeksDate),p(h.getElementById("milestones.oneMonth.date")).datepicker("setDate",w.oneMonthDate)}),m.find(".milestone-date-picker").datepicker(g),_(m),E(m),W(m),n=m,i="smokefree-stage.icfwebservices.com"===f.location.host?"386167128241977":"117297181948684",o=(p(f).width()-575)/2,s=(p(f).height()-400)/2,r="smokefree-stage.icfwebservices.com"===f.location.host?"https://smokefree-stage.icfwebservices.com/veterans/how-to-quit/build-your-quit-plan":"https://www.smokefree.gov/veterans/how-to-quit/build-your-quit-plan",l="smokefree-stage.icfwebservices.com"===f.location.host?"https://smokefree-stage.icfwebservices.com/sites/all/themes/smokefreegov/quit-plan/facebook-thanks.html":"https://www.smokefree.gov/sites/all/themes/smokefreegov/quit-plan/facebook-thanks.html",d="Iâ€™m quitting smoking. Want to become #smokefree with me?",c="status=1,width=575,height=400,top="+s+",left="+o,"/build-your-quit-plan"==f.location.href.toString().split(f.location.host)[1]&&(r="smokefree-stage.icfwebservices.com"===f.location.host?"https://smokefree-stage.icfwebservices.com/build-your-quit-plan":"https://www.smokefree.gov/build-your-quit-plan"),n.find("#send-message").on("click",function(){y({action:"SendMessage"})}),n.find(".dropdown-invite-friend .btn-link, .dropdown-tell-friends-family .btn-link").on("click",function(e){var t,n=p(this).attr("data-service");switch(p(this).attr("data-sharetext")&&(d=p(this).attr("data-sharetext")),n){case"Twitter":t="https://twitter.com/share?url="+encodeURIComponent(r)+"&text="+encodeURIComponent(d),f.open(t,"share",c);break;case"Facebook":t="https://www.facebook.com/dialog/share?app_id="+i+"&display=popup&href="+encodeURIComponent(r)+"&redirect_uri="+encodeURIComponent(l),f.open(t,"share",c);break;case"skip":var a={backgroundColor:"#3C84A4",color:"#FFF"};p(this).hasClass("tell-friends-family-skip")?p(".dropdown-toggle.btn.tell-friends-family").closest("button").css(a):p(this).hasClass("invite-friend-skip")&&p(".dropdown-toggle.btn.btn-invite").closest(".dropdown-toggle").css(a)}y({action:"InviteQuitBuddy",label:n})}),m.on("change",".bind-change",function(){var e=this.getAttribute("data-ga-action"),t=this.getAttribute("data-ga-label");u=p(h.getElementById("get."+this.id)),this.checked?(y({action:e,label:t}),u.addClass("in").attr("aria-hidden",!1)):u.removeClass("in").attr("aria-hidden",!0)}),p('input.fancy[type="checkbox"]:not(old)').click(function(e){e.stopPropagation()})}}),p.fn[n]=function(e){return this.each(function(){p.data(this,"plugin_"+n)||p.data(this,"plugin_"+n,new t(this,e))})}}(jQuery,window,document),jQuery("#quit-plan").buildQuitPlan();