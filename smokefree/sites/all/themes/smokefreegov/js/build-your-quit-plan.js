!function(d,c,s,o){"use strict";function u(e){var t={category:"QuitPlan",action:o,label:o},n={};d.extend(n,t,e),c.ga&&c.ga("send","event",n.category,n.action,n.label)}function r(e){var t=10;s.body.scrollTop>e.offset().top&&(t=-10),d("html, body").stop().animate({scrollTop:e.offset().top+t},250,"swing")}function l(e,t){var n="https://addevent.com/dir/?client="+Drupal.settings.icfi_api_keys.addevent+"&service="+encodeURIComponent(e)+"&start="+encodeURIComponent(t.date.replace(new RegExp("-","g"),"/"))+"&end="+encodeURIComponent(t.date.replace(new RegExp("-","g"),"/"))+"&title="+encodeURIComponent(t.title)+"&date_format="+encodeURIComponent("MM/DD/YYYY")+"&timezone="+encodeURIComponent("America/Chicago")+"&all_day_event=true";c.open(n)}function n(e,t){var n;switch(e){case D:n="#error-quit-day";break;case"errorTriggers":n="#error-triggers";break;case"errerReminders":n="#error-reminders"}d(n).collapse(t)}function f(e){return/[0-9]{2}-[0-9]{2}-[0-9]{4}/.test(e)}function m(e){var t=e.find(".milestone-input"),n=[];return t.each(function(){var e=d(this).val();0<e.length&&n.push(e)}),n.join(",")}function p(e,t){d(s.getElementById("get.milestones."+e)).find(".milestone-selections").append('<li><span class="plan-input date">{{date}}</span> <span class="plan-input title">{{title}}</span></li>'.replace("{{date}}",t.date).replace("{{title}}",t.title))}function t(e){e.on("click",".modal-reward .dropdown-menu button",function(e){e.preventDefault();var t,n=d(this).parents(".modal"),i=n.attr("data-milestone"),a=d(this).attr("data-service");!function(e){var t=!1,n=e.find(".milestone-date-picker").val(),i=m(e);return f(n)&&0<i.length&&(t=!0),t}(n)?(n.find(".validation-error").addClass("in"),n.find(".validation-success").removeClass("in")):(n.find(".validation-error").removeClass("in"),n.find(".validation-success").addClass("in"),t={date:n.find(".milestone-date-picker").val(),title:m(n)},q[i].push(t),p(i,t),l(a,t),n.find(".milestone-input").val(""),n.find(".milestone-date-picker").datepicker("setDate",b[i]))})}function i(e){e.on("click",".modal-activity .dropdown-menu button",function(e){e.preventDefault(),e.stopPropagation();var t,n=d(this).parents(".modal"),i=n.attr("data-milestone"),a=d(this).attr("data-service");!function(e){var t=!1,n=e.find(".milestone-date-picker").val(),i=e.find(".milestone-input").eq(0).val();return f(n)&&0<i.length&&(t=!0),t}(n)?(n.find(".validation-error").addClass("in"),n.find(".validation-success").removeClass("in")):(n.find(".validation-error").removeClass("in"),n.find(".validation-success").addClass("in"),t={date:n.find(".milestone-date-picker").val(),title:n.find(".milestone-input").eq(0).val()},q[i].push(t),p(i,t),l(a,t),n.find(".milestone-input").val(""),n.find(".milestone-date-picker").datepicker("setDate",b[i]))})}function h(e){var n=[];return d.each(e,function(e,t){n.push(t.date+" "+t.title)}),n.join("<br />")}function a(e){var t,n=e.find("#build-your-quit-plan"),i=e.find("#get-quit-plan"),a=i.find("#get-quit-plan-header");e.find("#get-my-quit-plan").on("click",function(){(t=function(e){var a=!0;return e.find("#build-your-quit-plan").children("section").each(function(){var e,t=d(this),n=t.attr("data-validation"),i=t.attr("data-required")!==o;n!==o&&(!(e=C[n](t))&&i&&(a=!1),i&&!e?t.find(".validation-error").addClass("in"):i&&e&&t.find(".validation-error").removeClass("in"))}),a}(e))?(n.attr("aria-hidden",!0).removeClass("in"),d("#progress_bar").hide(),i.attr("aria-hidden",!1).addClass("in"),a.focus(),r(d("#get-quit-plan"))):r(d(".section-error.in").eq(0)),u({action:"GetQuitPlan",label:t?"valid":"invalid"})}),e.find("#edit-my-quit-plan, #edit-my-quit-plan-bottom").on("click",function(){n.attr("aria-hidden",!1).addClass("in"),i.attr("aria-hidden",!0).removeClass("in")}),e.find("#generate-pdf, #generate-pdf-bottom").on("click",function(){e.find("#milestones\\.24hours").val(h(q._24HoursDate)),e.find("#milestones\\.48hours").val(h(q._48HoursDate)),e.find("#milestones\\.oneWeek").val(h(q.oneWeekDate)),e.find("#milestones\\.twoWeeks").val(h(q.twoWeeksDate)),e.find("#milestones\\.oneMonth").val(h(q.oneMonthDate)),e.find("#build-your-quit-plan").submit(),u({action:"GetPrintablePDF"})})}var v="buildQuitPlan",g={propertyName:"value"},k={autoclose:!0,format:"mm-dd-yyyy"},D="errorQuitDay",w="show",y="hide",b={},q={_24HoursDate:[],_48HoursDate:[],oneWeekDate:[],twoWeeksDate:[],oneMonthDate:[]},C={"valid-checklist":function(e){var t=e.find('input[type="checkbox"]:checked').length,n=e.eq(0).attr("id");return 0===t?d(s.getElementById("get."+n)).removeClass("in"):d(s.getElementById("get."+n)).addClass("in"),0<t},"valid-milestone":function(e){var t,n,i=0,a=e.find("#quit-day").eq(0).val().length,o=e.eq(0).attr("id");return d.each(q,function(e,t){var n=t.length;i+=n,n?d("#get\\.milestones\\."+e).addClass("in"):d("#get\\.milestones\\."+e).removeClass("in")}),t=q._48HoursDate.length+q.twoWeeksDate.length,n=q._24HoursDate.length+q.oneWeekDate.length+q.oneMonthDate.length,0===i?d(s.getElementById("get."+o)).removeClass("in"):d(s.getElementById("get."+o)).addClass("in"),0===t?d(s.getElementById("get.milestones.activites")).removeClass("in"):d(s.getElementById("get.milestones.activites")).addClass("in"),0===n?d(s.getElementById("get.milestones.rewards")).removeClass("in"):d(s.getElementById("get.milestones.rewards")).addClass("in"),0<a}};function I(e,t){this.element=e,this.settings=d.extend({},g,t),this._defaults=g,this._name=v,this.init()}d.extend(I.prototype,{init:function(){var e=d(this.element);!function(e){e.on("click",".trigger-scroll",function(e){e.preventDefault();var t=d(this.hash);r(t)})}(e),function(i){var t=i.find("#quit-day"),e=i.find("#milestones");t.datepicker(k).on("changeDate",function(){f(t.val())?(i.trigger("dateSet.quitPlan"),n(D,y),u({action:"QuitDate",label:t.val()})):n(D,w)}),t.on("blur",function(){f(t.val())?(i.trigger("dateSet.quitPlan"),n(D,y)):n(D,w)}),i.one("dateSet.quitPlan",function(){e.addClass("in")}),d("#dropdown-add-calendar-quit-day button").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=i.find("#quit-day").val(),n=d(this).attr("data-service");f(t)&&l(n,{date:t,title:"My quit day"})}),i.on("dateSet.quitPlan",function(){var e;d("#get-quit-day").text(t.val()),b.quitDate=t.datepicker("getDate"),e=b.quitDate.getDate(),b._24HoursDate=new Date(b.quitDate),b._24HoursDate.setDate(e+1),b._48HoursDate=new Date(b.quitDate),b._48HoursDate.setDate(e+2),b.oneWeekDate=new Date(b.quitDate),b.oneWeekDate.setDate(e+7),b.twoWeeksDate=new Date(b.quitDate),b.twoWeeksDate.setDate(e+14),b.oneMonthDate=new Date(b.quitDate),b.oneMonthDate.setMonth(b.quitDate.getMonth()+1),d(s.getElementById("milestones.24Hours.date")).datepicker("setDate",b._24HoursDate),d(s.getElementById("milestones.48Hours.date")).datepicker("setDate",b._48HoursDate),d(s.getElementById("milestones.oneWeek.date")).datepicker("setDate",b.oneWeekDate),d(s.getElementById("milestones.twoWeeks.date")).datepicker("setDate",b.twoWeeksDate),d(s.getElementById("milestones.oneMonth.date")).datepicker("setDate",b.oneMonthDate)})}(e),function(e){e.find(".milestone-date-picker").datepicker(k)}(e),t(e),i(e),a(e),function(e){var a="smokefree-stage.icfwebservices.com"===c.location.host?"386167128241977":"117297181948684",t=(d(c).width()-575)/2,n=(d(c).height()-400)/2,o="smokefree-stage.icfwebservices.com"===c.location.host?"https://smokefree-stage.icfwebservices.com/veterans/how-to-quit/build-your-quit-plan":"https://www.smokefree.gov/veterans/how-to-quit/build-your-quit-plan",s="smokefree-stage.icfwebservices.com"===c.location.host?"https://smokefree-stage.icfwebservices.com/sites/all/themes/smokefreegov/quit-plan/facebook-thanks.html":"https://www.smokefree.gov/sites/all/themes/smokefreegov/quit-plan/facebook-thanks.html",r="Iâ€™m quitting smoking. Want to become #smokefree with me?",l="status=1,width=575,height=400,top="+n+",left="+t;"/build-your-quit-plan"==c.location.href.toString().split(c.location.host)[1]&&(o="smokefree-stage.icfwebservices.com"===c.location.host?"https://smokefree-stage.icfwebservices.com/build-your-quit-plan":"https://www.smokefree.gov/build-your-quit-plan"),e.find("#send-message").on("click",function(){u({action:"SendMessage"})}),e.find(".dropdown-invite-friend .btn-link, .dropdown-tell-friends-family .btn-link").on("click",function(e){var t,n=d(this).attr("data-service");switch(d(this).attr("data-sharetext")&&(r=d(this).attr("data-sharetext")),n){case"Twitter":t="https://twitter.com/share?url="+encodeURIComponent(o)+"&text="+encodeURIComponent(r),c.open(t,"share",l);break;case"Facebook":t="https://www.facebook.com/dialog/share?app_id="+a+"&display=popup&href="+encodeURIComponent(o)+"&redirect_uri="+encodeURIComponent(s),c.open(t,"share",l);break;case"skip":var i={backgroundColor:"#3C84A4",color:"#FFF"};d(this).hasClass("tell-friends-family-skip")?d(".dropdown-toggle.btn.tell-friends-family").closest("button").css(i):d(this).hasClass("invite-friend-skip")&&d(".dropdown-toggle.btn.btn-invite").closest(".dropdown-toggle").css(i)}u({action:"InviteQuitBuddy",label:n})})}(e),function(e){var n;e.on("change",".bind-change",function(){var e=this.getAttribute("data-ga-action"),t=this.getAttribute("data-ga-label");n=d(s.getElementById("get."+this.id)),this.checked?(u({action:e,label:t}),n.addClass("in").attr("aria-hidden",!1)):n.removeClass("in").attr("aria-hidden",!0)})}(e),d('input.fancy[type="checkbox"]:not(old)').click(function(e){e.stopPropagation()})}}),d.fn[v]=function(e){return this.each(function(){d.data(this,"plugin_"+v)||d.data(this,"plugin_"+v,new I(this,e))})}}(jQuery,window,document),jQuery("#quit-plan").buildQuitPlan();